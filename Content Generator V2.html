<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Content & Facebook Scheduler</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1220; --card:#121a2c; --fg:#eaf2ff; --muted:#b7c4de; --brand:#4aa5ff; --ok:#54f0c0; --err:#ff7b7b; }
    *{ box-sizing:border-box }
    body{ margin:0; font-family:"Prompt",system-ui; background:linear-gradient(180deg,var(--bg),#0f1a30 60%); color:var(--fg); }
    .wrap{ max-width:980px; margin:auto; padding:20px; }
    h1{ font-size:clamp(22px,4vw,36px); margin:12px 0 8px }
    .card{ background:var(--card); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:16px; margin:14px 0; }
    label{ display:block; margin:8px 0 4px; color:var(--muted) }
    input, select, textarea{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.15); background:#0a1428; color:var(--fg) }
    textarea{ min-height:80px }
    .row{ display:grid; gap:12px; grid-template-columns: 1fr 1fr 1fr }
    .btn{ display:inline-flex; gap:8px; align-items:center; border:1px solid rgba(255,255,255,.15); padding:10px 14px; border-radius:12px; cursor:pointer; background:#1b2a46; color:var(--fg) }
    .btn.primary{ background:linear-gradient(180deg,#2f78ff,#1f62e6); border-color:transparent }
    .btn.ok{ background:linear-gradient(180deg,#1bbf8c,#14996f); border-color:transparent }
    .btn.warn{ background:#40321e; }
    .grid{ display:grid; gap:12px; grid-template-columns: repeat(auto-fit,minmax(240px,1fr)); }
    .pill{ display:inline-block; font-size:12px; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.15); color:var(--muted) }
    .muted{ color:var(--muted) }
    .status{ margin-top:8px; min-height:24px }
    .item{ background:#0a1428; border:1px dashed rgba(255,255,255,.15); border-radius:12px; padding:10px }
    .item h4{ margin:0 0 6px; font-size:14px }
    .right{ display:flex; gap:8px; flex-wrap:wrap }
    @media (max-width:720px){ .row{ grid-template-columns:1fr } }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>‚ú® AI Content & Facebook Scheduler</h1>
    <p class="muted">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå + ‡πÅ‡∏Ñ‡∏õ‡∏ä‡∏±‡πà‡∏ô + Image Prompts ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏•‡∏á‡πÄ‡∏û‡∏à Facebook ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏£‡∏∑‡∏≠ <strong>‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤</strong> ‡πÑ‡∏î‡πâ ‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ <span class="pill">Gemini</span> ‡∏´‡∏£‡∏∑‡∏≠ <span class="pill">OpenAI</span></p>

    <div class="card">
      <div class="row">
        <div>
          <label>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (Topic)</label>
          <input id="topic" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô, ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ..." />
        </div>
        <div>
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5)</label>
          <select id="count">
            <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
          </select>
        </div>
        <div>
          <label>‡πÇ‡∏°‡πÄ‡∏î‡∏•</label>
          <select id="provider">
            <option value="gemini">Gemini (Google)</option>
            <option value="openai">OpenAI (ChatGPT)</option>
          </select>
        </div>
      </div>
      <div class="right" style="margin-top:12px">
        <button class="btn primary" onclick="generate()">Generate</button>
        <span id="genStatus" class="status"></span>
      </div>
    </div>

    <div id="result" style="display:none;">
      <div class="grid">
        <div class="card">
          <h3>üìù Content</h3>
          <div id="contentList"></div>
        </div>
        <div class="card">
          <h3>üí¨ Captions</h3>
          <div id="captionList"></div>
        </div>
        <div class="card">
          <h3>üé® Image Prompts</h3>
          <div id="imageList"></div>
        </div>
      </div>

      <div class="card">
        <h3>‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÇ‡∏û‡∏™‡∏ï‡πå</h3>
        <textarea id="selectedMessage" placeholder="‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° '‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ' ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
        <div class="row" style="margin-top:8px">
          <div>
            <label>‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</label>
            <button class="btn ok" onclick="postNow()">‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏à</button>
          </div>
          <div>
            <label>‡∏´‡∏£‡∏∑‡∏≠ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏û‡∏™‡∏ï‡πå</label>
            <input id="scheduleAt" type="datetime-local" />
          </div>
          <div style="align-self:end">
            <button class="btn" onclick="schedulePost()">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏û‡∏™‡∏ï‡πå</button>
          </div>
        </div>
        <div id="postStatus" class="status"></div>
      </div>
    </div>

    <div class="card">
      <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h3>
      <p class="muted">‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ú‡πà‡∏≤‡∏ô Proxy ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (Render/Server) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‚Äî ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡∏µ‡∏¢‡πå‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</p>
      <label>Proxy Base URL</label>
      <input id="proxyUrl" placeholder="‡πÄ‡∏ä‡πà‡∏ô https://your-proxy.onrender.com" />
      <div class="right" style="margin-top:8px">
        <button class="btn" onclick="saveProxy()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <span id="proxyStatus" class="status"></span>
      </div>
    </div>

  </div>

<script>
  // ---- Helpers
  const $ = (id)=>document.getElementById(id);
  function uiItem(text, idx, targetTextareaId){
    const div = document.createElement('div');
    div.className = 'item';
    div.innerHTML = '<h4>#'+(idx+1)+'</h4><div class="muted" style="white-space:pre-wrap">'+escapeHtml(text)+'</div><div class="right" style="margin-top:8px"><button class="btn" data-text="'+encodeURIComponent(text)+'">‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ</button><button class="btn" onclick="copyText(`'+text.replace(/`/g,'\\`')+'`)">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button></div>';
    div.querySelector('button').onclick = ()=> { $(targetTextareaId).value = text; window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'}); };
    return div;
  }
  function escapeHtml(s){ return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
  function toast(el, msg){ el.textContent = msg; setTimeout(()=>el.textContent='', 4000); }
  function loadProxy(){ const v = localStorage.getItem('proxy_base'); if(v) $('proxyUrl').value = v; }
  function getProxy(){ return $('proxyUrl').value.trim() || localStorage.getItem('proxy_base') || ''; }
  function saveProxy(){ const v = $('proxyUrl').value.trim(); if(!v) return toast($('proxyStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Proxy URL'); localStorage.setItem('proxy_base', v); toast($('proxyStatus'),'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß'); }

  loadProxy();

  async function generate(){
    const proxy = getProxy();
    if (!proxy) return toast($('genStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Proxy URL ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô');
    const topic = $('topic').value.trim();
    const count = parseInt($('count').value,10);
    const provider = $('provider').value;
    if(!topic) return toast($('genStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (Topic)');

    $('genStatus').textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤...';
    try{
      const res = await fetch(proxy + '/ai/generate', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ provider, topic, count })
      });
      const data = await res.json();
      if(!res.ok) throw new Error(data.error || res.statusText);

      // render lists
      $('contentList').innerHTML = '';
      $('captionList').innerHTML = '';
      $('imageList').innerHTML = '';
      (data.content || []).forEach((t,i)=> $('contentList').appendChild(uiItem(t,i,'selectedMessage')));
      (data.captions || []).forEach((t,i)=> $('captionList').appendChild(uiItem(t,i,'selectedMessage')));
      (data.image_prompts || []).forEach((t,i)=> $('imageList').appendChild(uiItem(t,i,'selectedMessage')));

      $('result').style.display = 'block';
      toast($('genStatus'),'‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‚úÖ');
    }catch(err){
      console.error(err);
      toast($('genStatus'),'‚ùå Error: ' + err.message);
    }
  }

  async function postNow(){
    const proxy = getProxy();
    const message = $('selectedMessage').value.trim();
    if(!proxy) return toast($('postStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Proxy URL');
    if(!message) return toast($('postStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô');
    $('postStatus').textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå...';
    try{
      const res = await fetch(proxy + '/fb/post-now', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message })
      });
      const data = await res.json();
      if(!res.ok) throw new Error(data.error || JSON.stringify(data));
      toast($('postStatus'),'‚úÖ ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Post ID: ' + (data.id || '‚Äî'));
    }catch(err){
      toast($('postStatus'),'‚ùå ‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + err.message);
    }
  }

  async function schedulePost(){
    const proxy = getProxy();
    const message = $('selectedMessage').value.trim();
    const dt = $('scheduleAt').value;
    if(!proxy) return toast($('postStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Proxy URL');
    if(!message) return toast($('postStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô');
    if(!dt) return toast($('postStatus'),'‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤');
    $('postStatus').textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤...';
    try{
      const res = await fetch(proxy + '/fb/schedule', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message, isoDatetime: dt })
      });
      const data = await res.json();
      if(!res.ok) throw new Error(data.error || JSON.stringify(data));
      toast($('postStatus'),'‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß! Post ID: ' + (data.id || '‚Äî'));
    }catch(err){
      toast($('postStatus'),'‚ùå ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + err.message);
    }
  }

  function copyText(t){
    navigator.clipboard.writeText(t).then(()=>{
      toast($('postStatus'),'‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß');
    });
  }
</script>
</body>
</html>
