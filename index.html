<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Content Generator + Manual Wake</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9fafb; padding: 20px; }
    h1 { color: #0066cc; }
    .card { background: white; padding: 20px; border-radius: 8px; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
    button { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; background: #0066cc; color: white; }
    button:hover { background: #004a99; }
    .status { padding: 10px; margin-top: 10px; border-radius: 5px; font-weight: bold; }
    .green { background: #d4edda; color: #155724; }
    .orange { background: #fff3cd; color: #856404; }
    .red { background: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h1>‚ú® Content & Image Generator</h1>

  <div class="card">
    <label>‡πÉ‡∏™‡πà Topic ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå:</label>
    <input type="text" id="topic" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô, ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ...">
    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (1‚Äì5):</label>
    <input type="number" id="count" min="1" max="5" value="1">
    <button onclick="generateContent()">Generate Content</button>
  </div>

  <div class="card">
    <h3>üñ•Ô∏è Server Status</h3>
    <button onclick="wakeServer()">Wake Server</button>
    <div id="serverStatus" class="status red">üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</div>
  </div>

  <div id="result" class="card" style="display:none;">
    <h2>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</h2>
    <p id="postText"></p>
    <pre id="imagePrompt"></pre>
  </div>

  <script>
    const API_URL = "https://YOUR-RENDER-URL.onrender.com"; // üëà ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô proxy ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

    async function checkStatus() {
      const statusBox = document.getElementById("serverStatus");
      try {
        const res = await fetch(API_URL + "/");
        if (res.ok) {
          statusBox.className = "status green";
          statusBox.innerText = "üü¢ Server ‡∏ï‡∏∑‡πà‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
        } else {
          statusBox.className = "status red";
          statusBox.innerText = "üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà";
        }
      } catch {
        statusBox.className = "status red";
        statusBox.innerText = "üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà";
      }
    }

    async function wakeServer() {
      const statusBox = document.getElementById("serverStatus");
      statusBox.className = "status orange";
      statusBox.innerText = "üü† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏∏‡∏Å Server...";
      try {
        const res = await fetch(API_URL + "/");
        if (res.ok) {
          statusBox.className = "status green";
          statusBox.innerText = "üü¢ Server ‡∏ï‡∏∑‡πà‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
        } else {
          statusBox.className = "status red";
          statusBox.innerText = "üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà";
        }
      } catch {
        statusBox.className = "status red";
        statusBox.innerText = "üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà";
      }
    }

    async function generateContent() {
      const topic = document.getElementById("topic").value;
      const count = document.getElementById("count").value;
      if (!topic) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Topic ‡∏Å‡πà‡∏≠‡∏ô");

      document.getElementById("result").style.display = "block";
      document.getElementById("postText").innerText = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå...";
      document.getElementById("imagePrompt").innerText = "";

      try {
        const res = await fetch(API_URL + "/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ topic, count, model: "gemini-2.0-flash" })
        });
        const data = await res.json();

        const text = data?.data?.candidates?.[0]?.content?.parts?.[0]?.text || "‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå";
        document.getElementById("postText").innerText = text;
        document.getElementById("imagePrompt").innerText = "Image Prompt: " + topic;
      } catch (e) {
        document.getElementById("postText").innerText = "‚ùå Error: " + e.message;
      }
    }

    // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ server ‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    checkStatus();
  </script>
</body>
</html>
