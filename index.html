<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‚ú® AI Content & Image Generator</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f9fafb;
      margin: 0; padding: 20px;
    }
    h1 { color: #2563eb; }
    .form-box, .status-box, .result-box {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    label { font-weight: bold; margin-top: 10px; display: block; }
    select, input, button {
      margin-top: 5px; margin-bottom: 15px;
      padding: 8px; border-radius: 5px; border: 1px solid #ddd; width: 100%;
    }
    button { cursor: pointer; font-weight: bold; }
    .btn-primary { background: #2563eb; color: white; border: none; }
    .btn-orange { background: orange; color: white; border: none; }
    .status { font-weight: bold; margin-top: 10px; }
    .green { color: green; } .orange { color: orange; } .red { color: red; }
    .progress { height: 12px; background: #e5e7eb; border-radius: 6px; overflow: hidden; margin-top: 10px; }
    .progress-bar { height: 100%; width: 0%; background: linear-gradient(to right,#3b82f6,#1e40af); transition: width 0.3s; }
    .content-box { border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-top: 15px; background: #f3f4f6; }
    .content-box img { max-width: 100%; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>‚ú® AI Content & Image Generator</h1>

  <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏° -->
  <div class="form-box">
    <label>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (Topic):</label>
    <input id="topic" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏•‡∏¢, ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô..." />

    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5):</label>
    <input id="count" type="number" min="1" max="5" value="1" />

    <label>‡πÇ‡∏´‡∏°‡∏î:</label>
    <select id="mode">
      <option>Text (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÇ‡∏û‡∏™‡∏ï‡πå)</option>
      <option>Image (‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö)</option>
    </select>

    <label>‡πÇ‡∏°‡πÄ‡∏î‡∏•:</label>
    <select id="model">
      <option value="gemini-2.5-flash">gemini-2.5-flash ‚ö°</option>
      <option value="gemini-2.5-pro">gemini-2.5-pro üíé</option>
    </select>

    <label>‡πÇ‡∏ó‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏†‡∏≤‡∏û:</label>
    <select id="tone">
      <option>‡πÅ‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ üìò</option>
      <option>‡πÅ‡∏ô‡∏ß‡∏ï‡∏•‡∏Å‡∏Ç‡∏≥‡πÜ üòÖ</option>
      <option>‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î üíº</option>
    </select>

    <label>‡∏†‡∏≤‡∏©‡∏≤:</label>
    <select id="lang">
      <option>‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ üáπüá≠</option>
      <option>English üá¨üáß</option>
    </select>

    <label>‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°:</label>
    <select id="platform">
      <option>Facebook</option>
      <option>Instagram</option>
      <option>Website</option>
    </select>

    <button class="btn-primary" onclick="generateContent()">üöÄ Generate Content</button>
  </div>

  <!-- Server Status -->
  <div class="status-box">
    <h3>üíª Server Status</h3>
    <button class="btn-orange" onclick="wakeServer()">Wake Server</button>
    <div id="serverStatus" class="status red">üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</div>
    <div class="progress"><div id="wakeBar" class="progress-bar"></div></div>
  </div>

  <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
  <div class="result-box">
    <h3>üìÑ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
    <div id="statusBox"></div>
    <div class="progress"><div id="progressBar" class="progress-bar"></div></div>
    <div id="resultBox"></div>
  </div>

<script>
const API_URL = "https://fb-proxy-m63e.onrender.com";

// Wake Server
async function wakeServer() {
  const statusDiv = document.getElementById("serverStatus");
  const wakeBar = document.getElementById("wakeBar");
  let progress = 0;
  statusDiv.className = "status orange";
  statusDiv.innerText = "üü† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏∏‡∏Å Server...";

  const interval = setInterval(() => {
    if (progress < 90) {
      progress += 10;
      wakeBar.style.width = progress + "%";
    }
  }, 1000);

  try {
    const res = await fetch(API_URL + "/");
    clearInterval(interval);
    wakeBar.style.width = "100%";
    if (res.ok) {
      statusDiv.className = "status green";
      statusDiv.innerText = "üü¢ Server ‡∏ï‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß!";
    } else {
      statusDiv.className = "status red";
      statusDiv.innerText = "üî¥ Server ‡∏õ‡∏•‡∏∏‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    }
  } catch (err) {
    clearInterval(interval);
    wakeBar.style.width = "100%";
    statusDiv.className = "status red";
    statusDiv.innerText = "üî¥ Error: " + err.message;
  }
}

// Generate Content
async function generateContent() {
  const statusBox = document.getElementById("statusBox");
  const resultBox = document.getElementById("resultBox");
  const bar = document.getElementById("progressBar");

  statusBox.className = "status orange";
  statusBox.innerText = "üü† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå...";
  resultBox.innerHTML = "";
  bar.style.width = "0%";

  let progress = 0;
  const progressInterval = setInterval(() => {
    if (progress < 90) {
      progress += 10;
      bar.style.width = progress + "%";
    }
  }, 500);

  try {
    const res = await fetch(API_URL + "/generate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        topic: document.getElementById("topic").value,
        count: document.getElementById("count").value,
        model: document.getElementById("model").value,
        mode: document.getElementById("mode").value,
        tone: document.getElementById("tone").value,
        lang: document.getElementById("lang").value,
        platform: document.getElementById("platform").value,
      }),
    });

    if (!res.ok) throw new Error("HTTP " + res.status);

    const data = await res.json();
    clearInterval(progressInterval);
    bar.style.width = "100%";

    if (data.status === "ok") {
      showResult(data.data, document.getElementById("mode").value);
      statusBox.className = "status green";
      statusBox.innerText = "üü¢ ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!";
    } else {
      statusBox.className = "status red";
      statusBox.innerText = "üî¥ Error: " + (data.error || "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏");
      resultBox.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
    }
  } catch (err) {
    clearInterval(progressInterval);
    bar.style.width = "100%";
    statusBox.className = "status red";
    statusBox.innerText = "üî¥ Error: " + err.message;
  }
}

function showResult(data, mode) {
  const resultBox = document.getElementById("resultBox");

  if (mode.includes("Text")) {
    const text = data?.candidates?.[0]?.content?.parts?.[0]?.text || "‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå";
    resultBox.innerHTML = `
      <div class="content-box">
        <p>${text.replace(/\n/g, "<br>")}</p>
        <button onclick="copyToClipboard(\`${text}\`)">üìã Copy</button>
      </div>`;
  } else if (mode.includes("Image")) {
    const imageUrl = data?.candidates?.[0]?.content?.parts?.[0]?.text || null;
    if (imageUrl) {
      resultBox.innerHTML = `
        <div class="content-box">
          <img src="${imageUrl}" alt="Generated Image"/>
          <a href="${imageUrl}" download="gemini-image.png">
            <button>‚¨áÔ∏è Download</button>
          </a>
        </div>`;
    } else {
      resultBox.innerHTML = `<p>‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</p>`;
    }
  } else {
    resultBox.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
  }
}

function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(() => {
    alert("‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
  });
}
</script>
</body>
</html>
