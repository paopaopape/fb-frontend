<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‚ú® AI Content & Image Generator</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #f4f6f9;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #0d47a1;
      color: #fff;
      padding: 15px 30px;
      font-size: 1.6rem;
      font-weight: bold;
    }
    .container {
      max-width: 900px;
      margin: 30px auto;
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin: 15px 0 5px;
      font-weight: 600;
    }
    input, select {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      margin-top: 20px;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
    }
    .btn-primary { background: #1976d2; color: #fff; }
    .btn-primary:hover { background: #1259a6; }
    .btn-copy { background: #43a047; color: #fff; margin-left: 10px; }
    .btn-copy:hover { background: #2e7d32; }
    .btn-wake { background: #ff9800; color: #fff; }
    .btn-wake:hover { background: #ef6c00; }
    .status {
      margin-top: 15px;
      padding: 12px;
      border-radius: 6px;
      font-weight: bold;
    }
    .green { background: #e8f5e9; color: #2e7d32; }
    .orange { background: #fff3e0; color: #ef6c00; }
    .red { background: #ffebee; color: #c62828; }
    .progress-container {
      margin-top: 15px;
      background: #eee;
      border-radius: 6px;
      overflow: hidden;
      height: 20px;
    }
    .progress-bar {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, #42a5f5, #0d47a1);
      transition: width 0.3s;
    }
    .result-card {
      margin-top: 25px;
      padding: 20px;
      border-radius: 8px;
      background: #fafafa;
      border: 1px solid #ddd;
    }
    .result-card h3 { margin-top: 0; color: #0d47a1; }
    pre {
      background: #111;
      color: #0f0;
      padding: 12px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.9rem;
    }
    .image-preview {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .image-preview img {
      max-width: 280px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <header>‚ú® AI Content & Image Generator</header>

  <div class="container">
    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏° -->
    <label>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (Topic):</label>
    <input type="text" id="topic" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏•‡∏¢, ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô..." />

    <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5):</label>
    <input type="number" id="num" min="1" max="5" value="1" />

    <label>‡πÇ‡∏´‡∏°‡∏î:</label>
    <select id="mode">
      <option value="Text">Text (‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÇ‡∏û‡∏™‡∏ï‡πå)</option>
      <option value="Image">Image (‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö)</option>
    </select>

    <label>‡πÇ‡∏°‡πÄ‡∏î‡∏•:</label>
    <select id="model">
      <option value="gemini-2.0-flash">Gemini 2.0 Flash ‚ö°</option>
      <option value="gemini-2.0-pro">Gemini 2.0 Pro üß†</option>
    </select>

    <label>‡πÇ‡∏ó‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏†‡∏≤‡∏û:</label>
    <select id="tone">
      <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢">‡πÅ‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢ üìò</option>
      <option value="‡∏ï‡∏•‡∏Å">‡πÅ‡∏ô‡∏ß‡∏ï‡∏•‡∏Å‡∏Ç‡∏≥‡πÜ üòÇ</option>
      <option value="‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á">‡πÅ‡∏ô‡∏ß‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á üî•</option>
      <option value="‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏£‡∏á‡∏ö‡∏±‡∏ô‡∏î‡∏≤‡∏•‡πÉ‡∏à ‚ú®</option>
    </select>

    <label>‡∏†‡∏≤‡∏©‡∏≤:</label>
    <select id="lang">
      <option value="th">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ üáπüá≠</option>
      <option value="en">English üá¨üáß</option>
    </select>

    <label>‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°:</label>
    <select id="platform">
      <option value="Facebook">Facebook</option>
      <option value="Instagram">Instagram</option>
      <option value="Twitter">Twitter</option>
    </select>

    <button class="btn-primary" onclick="generateContent()">üöÄ Generate Content</button>

    <!-- Wake Server -->
    <h3>üñ•Ô∏è Server Status</h3>
    <button class="btn-wake" onclick="wakeServer()">Wake Server</button>
    <div id="serverStatus" class="status red">üî¥ Server ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</div>
    <div class="progress-container"><div id="progressBar" class="progress-bar"></div></div>

    <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
    <div id="resultBox"></div>
  </div>

  <script>
    const API_URL = "https://fb-proxy-m63e.onrender.com";

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Wake Server
    async function wakeServer() {
      const statusBox = document.getElementById("serverStatus");
      const bar = document.getElementById("progressBar");
      let progress = 0;
      statusBox.className = "status orange";
      statusBox.innerText = "üü† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏∏‡∏Å Server...";
      bar.style.width = "0%";

      // Progress Bar 0‚Äì100%
      const progressInterval = setInterval(() => {
        progress += 20;
        if (progress > 100) progress = 100;
        bar.style.width = progress + "%";
      }, 1000);

      // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥ (‡∏£‡∏ß‡∏° 1 ‡∏ô‡∏≤‡∏ó‡∏µ)
      let checks = 0;
      const checkInterval = setInterval(async () => {
        checks++;
        try {
          const res = await fetch(API_URL + "/");
          if (res.ok) {
            clearInterval(progressInterval);
            clearInterval(checkInterval);
            statusBox.className = "status green";
            statusBox.innerText = "üü¢ Server ‡∏ï‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
            bar.style.width = "100%";
          }
        } catch (err) {
          console.log("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏∑‡πà‡∏ô:", err);
        }
        if (checks >= 6) {
          clearInterval(progressInterval);
          clearInterval(checkInterval);
          statusBox.className = "status red";
          statusBox.innerText = "üî¥ Server ‡∏õ‡∏•‡∏∏‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        }
      }, 10000);
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Generate Content
    async function generateContent() {
      const topic = document.getElementById("topic").value;
      const num = document.getElementById("num").value;
      const mode = document.getElementById("mode").value;
      const model = document.getElementById("model").value;
      const tone = document.getElementById("tone").value;
      const lang = document.getElementById("lang").value;
      const platform = document.getElementById("platform").value;
      const statusBox = document.getElementById("serverStatus");
      const resultBox = document.getElementById("resultBox");
      const bar = document.getElementById("progressBar");

      if (!topic) {
        alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
        return;
      }

      statusBox.className = "status orange";
      statusBox.innerText = "üü† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå...";
      bar.style.width = "0%";

      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += 15;
        if (progress > 100) progress = 100;
        bar.style.width = progress + "%";
      }, 800);

      try {
        const res = await fetch(API_URL + "/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ topic, num, mode, model, tone, lang, platform })
        });

        const data = await res.json();
        clearInterval(progressInterval);

        if (data.status === "ok") {
          showResult(data.data, mode);
          statusBox.className = "status green";
          statusBox.innerText = "üü¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!";
          bar.style.width = "100%";
        } else {
          statusBox.className = "status red";
          statusBox.innerText = "üî¥ Error: " + (data.error || "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏");
        }
      } catch (err) {
        clearInterval(progressInterval);
        console.error(err);
        statusBox.className = "status red";
        statusBox.innerText = "üî¥ Error: ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ API ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      }
    }

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    function showResult(result, mode) {
      const resultBox = document.getElementById("resultBox");
      resultBox.innerHTML = "";

      const card = document.createElement("div");
      card.className = "result-card";

      const title = document.createElement("h3");
      title.innerText = "üìÑ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå";
      card.appendChild(title);

      if (mode === "Image" && result.images) {
        const imgContainer = document.createElement("div");
        imgContainer.className = "image-preview";
        result.images.forEach(url => {
          const img = document.createElement("img");
          img.src = url;
          imgContainer.appendChild(img);
        });
        card.appendChild(imgContainer);
      } else {
        const pre = document.createElement("pre");
        pre.innerText = typeof result === "string" ? result : JSON.stringify(result, null, 2);
        card.appendChild(pre);

        const copyBtn = document.createElement("button");
        copyBtn.innerText = "üìã Copy";
        copyBtn.className = "btn-copy";
        copyBtn.onclick = () => {
          navigator.clipboard.writeText(pre.innerText);
          copyBtn.innerText = "‚úÖ Copied!";
          setTimeout(() => copyBtn.innerText = "üìã Copy", 2000);
        };
        card.appendChild(copyBtn);
      }

      resultBox.appendChild(card);
    }
  </script>
</body>
</html>
